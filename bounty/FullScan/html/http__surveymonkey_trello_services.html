<html><body><script src="https://p.trellocdn.com/power-up.min.js"></script><script>!function e(r,t,n){function o(u,i){if(!t[u]){if(!r[u]){var a="function"==typeof require&&require;if(!i&&a)return a(u,!0);if(s)return s(u,!0);var l=new Error("Cannot find module '"+u+"'");throw l.code="MODULE_NOT_FOUND",l}var c=t[u]={exports:{}};r[u][0].call(c.exports,function(e){var t=r[u][1][e];return o(t||e)},c,c.exports,e,r,t,n)}return t[u].exports}for(var s="function"==typeof require&&require,u=0;u<n.length;u++)o(n[u]);return o}({1:[function(e,r,t){"use strict";e("../src/api");var n=e("../src/i18n-settings"),o=e("../src/surveymonkey-button"),s=(e("../src/surveymonkey-error"),e("../src/urls")),u=e("../src/title-for-url"),i=TrelloPowerUp.Promise,a="./images/icon.svg";TrelloPowerUp.initialize({"attachment-sections":function(e,r){var t=r.entries.filter(function(e){var r=s.parse(e.url);return r.isCollectorUrl||r.isAnalysisUrl});return 0==t.length?[]:i.map(t,function(r){var t=u(e,r.url,r.name).then(function(r){return r&&!/^https:/.test(r)?r:e.localizeKey("surveymonkey_survey")});return{id:r.id,claimed:[r],icon:a,title:function(){return t},content:{type:"iframe",url:e.signUrl('./survey.html?ver=dd052949dd&',{url:r.url,name:r.name})}}})},"card-badges":function(e,r){var t=r.attachments.filter(function(e){var r=s.parse(e.url);return r.isCollectorUrl||r.isAnalysisUrl});return t.length>0?[{text:t.length,icon:a}]:[]},"card-buttons":function(e){return[{icon:a,text:e.localizeKey("surveymonkey"),callback:o}]},"format-url":function(e,r){if(s.parse(r.url).surveyId)return u(e,r.url,r.name).then(function(e){return{icon:a,text:e}});throw e.NotHandled()}},{targetOrigin:"https://trello.com",localization:n})},{"../src/api":2,"../src/i18n-settings":3,"../src/surveymonkey-button":4,"../src/surveymonkey-error":5,"../src/title-for-url":6,"../src/urls":7}],2:[function(e,r,t){"use strict";var n=e("./surveymonkey-error"),o=TrelloPowerUp.Promise,s={1:n.NotAuthorized,2:n.InvalidUserCredentials,3:n.InvalidRequest,4:n.UnknownUser,5:n.SystemError},u=function(e,r){return new(s[e]||n.Unknown)(r)},i=function(e,r,t,s,i){return o.all([r.get("organization","private","token"),r.get("board","private","token")]).spread(function(e,r){return r||e}).then(function(r){return new o(function(o,a){if(!r)return a(new n.Unauthorized);var l=new XMLHttpRequest,c="./proxy?url="+encodeURIComponent("https://api.surveymonkey.net/v"+t+"/surveys/"+s);l.open(e,c,!0),l.setRequestHeader("Authorization","bearer "+r),l.setRequestHeader("Content-Type","application/json"),l.onload=function(){var e=void 0;try{e=JSON.parse(l.responseText)}catch(e){return a(l.responseText.indexOf("Developer Over Qp")>-1?new n.OverQuota:new n.InvalidResponse(e.message))}return 0==e.status?o(e):a(u(e.status,e.errmsg))},l.send(JSON.stringify(i))})})},a=function(e,r,t,n){return i("POST",e,r,t,n)},l=function e(r,t,n,s,u){return new o(function(o,i){return a(r,2,"get_respondent_list",{survey_id:t,start_modified_date:n,fields:["status","date_modified","collector_id"],page:u}).then(function(a){return a.data.respondents.length==a.data.page_size&&u*a.data.page_size<s?e(r,t,n,s,u+1).then(function(e){return o(a.data.respondents.concat(e))}).catch(i):o(a.data.respondents)})})};r.exports={getAllSurveys:function(e){return a(e,2,"get_survey_list",{fields:["title","date_modified","analysis_url"]})},getSurveyDetails:function(e,r){return a(e,2,"get_survey_details",{survey_id:r})},getRespondentList:function(e,r){var t=new Date;return t.setDate(t.getDate()-7),l(e,r,t.toISOString().replace("T"," ").slice(0,-5),5e3,1)},getCollectorList:function(e,r){return a(e,2,"get_collector_list",{survey_id:r,fields:["url","open","type","name","date_created","date_modified"]})}}},{"./surveymonkey-error":5}],3:[function(e,r,t){"use strict";r.exports={defaultLocale:"en",supportedLocales:["cs","de","en","es","fi","fr","hu","it","ja","nb","nl","pl","pt-BR","ru","sv","th","tr","uk","vi","zh-Hans","zh-Hant"],resourceUrl:"./strings/{locale}.json?ver=06ccdfeda4"}},{}],4:[function(e,r,t){"use strict";var n=e("./api"),o=e("./surveymonkey-error"),s=function(e){return n.getAllSurveys(e).then(function(r){var t=r.data.surveys.map(function(e){return{text:e.title,url:e.analysis_url,callback:function(r){return n.getCollectorList(r,e.survey_id).then(function(t){var n=t.data.collectors.filter(function(e){return e.open&&"url"==e.type}),o=void 0;if(0==n.length)o={url:e.analysis_url+"#id="+e.survey_id,name:e.title};else{if(1!=n.length)return r.popup({title:r.localizeKey("select_collector"),items:n.map(function(r){return{text:r.name,callback:function(t){return t.attach({url:r.url+"#id="+e.survey_id,name:e.title}).then(function(){return t.closePopup()})}}}),search:{count:10,placeholder:r.localizeKey("search_collectors_ellipsis"),empty:r.localizeKey("no_collectors_found")}});o={url:n[0].url+"#id="+e.survey_id,name:e.title}}if(o)return r.attach(o).then(function(){return r.closePopup()})})}}});return e.popup({title:e.localizeKey("attach_survey"),items:t,search:{count:10,placeholder:e.localizeKey("search_surveys_ellipsis"),empty:e.localizeKey("no_surveys_found")}})})};r.exports=function(e){return s(e).catch(o.Unauthorized,function(){return e.popup({title:e.localizeKey("authorize"),url:'./authorize.html?ver=240f6f4d17&',callback:function(e){return s(e)}})})}},{"./api":2,"./surveymonkey-error":5}],5:[function(e,r,t){"use strict";r.exports=TrelloPowerUp.util.makeErrorEnum("SurveyMonkey",["InvalidRequest","InvalidResponse","InvalidUserCredentials","NotAuthorized","NotFound","OverQuota","SystemError","Unauthorized","Unknown","UnknownUser"])},{}],6:[function(e,r,t){"use strict";var n=e("./api"),o=e("./surveymonkey-error"),s=e("./urls"),u=TrelloPowerUp.Promise;r.exports=function(e,r,t){if(t&&t!=r)return u.resolve(t);var i=s.parse(r);if(!i.surveyId)return u.resolve(r);var a=sessionStorage.getItem("surveymonkey-"+i.surveyId);return a?u.resolve(a):n.getSurveyDetails(e,i.surveyId).then(function(e){if(e.data){var t=e.data.title?e.data.title.text:e.data.nickname;if(t)return sessionStorage.setItem("surveymonkey-"+i.surveyId,t),t}return r}).catch(o,function(){return r})}},{"./api":2,"./surveymonkey-error":5,"./urls":7}],7:[function(e,r,t){"use strict";var n=function(e){return/^https:\/\/(?:www\.)?(?:[\w-]+\.)?(?:surveymonkey\.com|research\.net)/.test(e)};r.exports={isSurveyMonkey:n,parse:function(e){var r={url:e};if(!n(e))return r;r.isSurveyMonkeyUrl=!0;var t=/#id=(\d+)/.exec(e);return t&&(r.surveyId=t[1]),r.isCollectorUrl=/^https:\/\/(?:www\.)?(?:[\w-]+\.)?(?:surveymonkey\.com|research\.net)\/r\//.test(e),r.isAnalysisUrl=/^https:\/\/(?:www\.)?(?:[\w-]+\.)?surveymonkey\.com\/MySurvey_Responses/.test(e),r}}},{}]},{},[1]);</script></body></html>